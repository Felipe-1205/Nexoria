#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#
#           Drakonin Pack Vol.1            #
#             Mobs - Skills                #
#               by Nocsy                   #
#=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-#

############################################
#                  Egg                     #
############################################

#-----------  Sound -----------#
Nocsy_Drakonin_Egg_Sound:
  Conditions:
  - hastag{t=sound} false
  Skills:
  - addtag{t=sound} @self
  - sound{s=block.wood.hit;v=1;p=1.6}
  - delay 20
  - removetag{t=sound} @self

#-----------  Interaction -----------#
Nocsy_Drakonin_Egg_Interaction:
  Conditions:
  - hastag{t=interacted} false
  - hastag{t=eclode} false
  - variableEquals{var=caster.crack;value=4} castInstead Nocsy_Drakonin_Eclode
  Skills:
  - addtag{t=interacted} @self
  - variableadd{var=caster.crack;amount=1} @self
  - setAI{ai=true} @self
  - state{s=interact;li=0;lo=0;speed=1} @self
  - setAI{ai=false} @self
  - delay 26
  - removetag{t=interacted} @self
  
#-----------  Eclode -----------#
Nocsy_Drakonin_Eclode:
  Skills:
  - setAI{ai=true} @self
  - addtag{t=eclode} @self
  - state{s=eclode;li=0;lo=0;speed=1} @self
  - setAI{ai=false} @self
  - effect:particles{p=explosion_normal;amount=5;speed=0.1;hS=0.15;vS=0.15} @SelfLocation{y=0}
  - delay 20
  - effect:particles{p=explosion_normal;amount=6;speed=0.1;hS=0.15;vS=0.15} @SelfLocation{y=0}
  - delay 15
  - effect:particles{p=explosion_normal;amount=8;speed=0.1;hS=0.15;vS=0.15} @SelfLocation{y=0}
  - delay 10
  - effect:particles{p=explosion_normal;amount=8;speed=0.1;hS=0.15;vS=0.15} @SelfLocation{y=0}
  - delay 14
  - effect:particles{p=explosion_normal;amount=9;speed=0.1;hS=0.15;vS=0.25} @SelfLocation{y=0}
  - skill{s=Nocsy_Drakonin_SpawnRandom} @self
  - submodel{mid=nocsy_drakonin_egg;subpart=shell;remove=true} @self
  - delay 100
  - remove @self

Nocsy_Drakonin_SpawnRandom:
  Skills:
  - randomskill{s=Nocsy_Drakonin_Spawn-Fire,Nocsy_Drakonin_Spawn-Dark,Nocsy_Drakonin_Spawn-Water,Nocsy_Drakonin_Spawn-Cloud,Nocsy_Drakonin_Spawn-Volcanic,Nocsy_Drakonin_Spawn-Poison,Nocsy_Drakonin_Spawn-Forest,Nocsy_Drakonin_Spawn-Night} @self
  - effect:particles{p=explosion_normal;amount=5;speed=0.1;hS=0.15;vS=0.05} @SelfLocation{y=0}
  
Nocsy_Drakonin_Spawn-Fire:
  Skills:
  - summon{type=Nocsy_Drakonin-Fire-Baby;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;inheritFaction=true;sio=false} @SelfLocation{y=0.5}
Nocsy_Drakonin_Spawn-Dark:
  Skills:
  - summon{type=Nocsy_Drakonin-Dark-Baby;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;inheritFaction=true;sio=false} @SelfLocation{y=0.5}
Nocsy_Drakonin_Spawn-Water:
  Skills:
  - summon{type=Nocsy_Drakonin-Water-Baby;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;inheritFaction=true;sio=false} @SelfLocation{y=0.5}
Nocsy_Drakonin_Spawn-Cloud:
  Skills:
  - summon{type=Nocsy_Drakonin-Cloud-Baby;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;inheritFaction=true;sio=false} @SelfLocation{y=0.5}
Nocsy_Drakonin_Spawn-Volcanic:
  Skills:
  - summon{type=Nocsy_Drakonin-Volcanic-Baby;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;inheritFaction=true;sio=false} @SelfLocation{y=0.5}
Nocsy_Drakonin_Spawn-Poison:
  Skills:
  - summon{type=Nocsy_Drakonin-Poison-Baby;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;inheritFaction=true;sio=false} @SelfLocation{y=0.5}
Nocsy_Drakonin_Spawn-Forest:
  Skills:
  - summon{type=Nocsy_Drakonin-Forest-Baby;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;inheritFaction=true;sio=false} @SelfLocation{y=0.5}
Nocsy_Drakonin_Spawn-Night:
  Skills:
  - summon{type=Nocsy_Drakonin-Night-Baby;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;inheritFaction=true;sio=false} @SelfLocation{y=0.5}

############################################
#            GLOBAL Drakonin               #
############################################

#----------- Spell cast -----------#
Nocsy_Drakonin_Spell:
  Conditions:
  - hastag{t=start_fly} false
  - hastag{t=end_fly} false
  - hastag{t=fire} castInstead Nocsy_Drakonin_Spell-Fire
  - hastag{t=dark} castInstead Nocsy_Drakonin_Spell-Dark
  - hastag{t=water} castInstead Nocsy_Drakonin_Spell-Water
  - hastag{t=cloud} castInstead Nocsy_Drakonin_Spell-Cloud
  - hastag{t=volcanic} castInstead Nocsy_Drakonin_Spell-Volcanic
  - hastag{t=poison} castInstead Nocsy_Drakonin_Spell-Poison
  - hastag{t=forest} castInstead Nocsy_Drakonin_Spell-Forest
  - hastag{t=night} castInstead Nocsy_Drakonin_Spell-Night
  Skills:
  - remove @self

#----------- Engage Fly -----------#
Nocsy_Drakonin_StartFly:
  Conditions:
  - ModelHasDriver{} true
  - altitude{h=1.05to3000} true
  - hastag{t=start_fly} false
  - hastag{t=fly} false
  Skills:
  - skill{s=[
            - dismountmodel{p=mount} @self
            - delay 1
            - mountmodel{mode=flying} @Owner
            ]}
  - potion{type=SPEED;duration=25;level=4;hasParticles=false} @self
  - skill{s=Nocsy_Drakonin_StartFly-FORCE}

Nocsy_Drakonin_StartFly-FORCE:
  Conditions:
  - hastag{t=water} castInstead Nocsy_Drakonin_StartFly_Wyvern-FORCE
  - hastag{t=cloud} castInstead Nocsy_Drakonin_StartFly_Wyvern-FORCE
  - hastag{t=poison} castInstead Nocsy_Drakonin_StartFly_Wyvern-FORCE
  - hastag{t=night} castInstead Nocsy_Drakonin_StartFly_Wyvern-FORCE
  Skills:
  - addtag{t=start_fly} @self
  - state{s=fly_start;li=3;lo=3;speed=1.6} @self
  - setAI{ai=false} @self
  - delay 4
  - addtag{t=fly} @self
  - setAI{ai=true} @self
  - delay 10
  - skill{s=Nocsy_Drakonin_Sound_Flap} @self
  - particle{
             a=1;
             s=0.6;
             particle=explosion_normal;
             amount=1;
             d=true;
            } @Ring{r=3;points=20;yOffset=-1;}
  - delay 11
  - removetag{t=start_fly} @self
  - state{s=fly_loop;li=0;lo=0} @self

Nocsy_Drakonin_StartFly_Wyvern-FORCE:
  Skills:
  - addtag{t=start_fly} @self
  - state{s=fly_start;li=2;lo=0;speed=1.6} @self
  - addtag{t=fly} @self
  - setAI{ai=true} @self
  - delay 10
  - skill{s=Nocsy_Drakonin_Sound_Flap} @self
  - particle{
             a=1;
             s=0.6;
             particle=explosion_normal;
             amount=1;
             d=true;
            } @Ring{r=3;points=20;yOffset=-1;}
  - delay 10
  - state{s=fly_loop;li=0;lo=0} @self
  - removetag{t=start_fly} @self
  
#----------- Fly Loop -----------#
Nocsy_Drakonin_FlyLoop:
  Skills:
  - Aura{auraName=Nocsy_Drakonin_FlyLoop-Sound-Aura;onTick=Nocsy_Drakonin_Fly;interval=8;d=2147483646} @self
  - Aura{auraName=Nocsy_Drakonin_FlyLoopNoMount-Sound-Aura;onTick=Nocsy_Drakonin_Fly-NoMount;interval=8;d=2147483646} @self
  - Aura{auraName=Nocsy_Drakonin_FlyStartLoop-Sound-Aura;onTick=Nocsy_Drakonin_StartFly;interval=3;d=2147483646} @self
  - Aura{auraName=Nocsy_Drakonin_FlyLandLoop-Sound-Aura;onTick=Nocsy_Drakonin_FlyLand;interval=3;d=2147483646} @self

Nocsy_Drakonin_Fly-NoMount:
  Conditions:
  - ModelHasDriver{} false
  - hastag{t=fly} false
  - hastag{t=start_fly} false
  - altitude{h=1.05to3000} true
  Skills:
  - addtag{t=fly} @self

Nocsy_Drakonin_Fly:
  Conditions:
  - hastag{t=plunge} false
  - hastag{t=fly} true
  - hastag{t=start_fly} false
  - hastag{t=fly_animation} false
  - hastag{t=end_fly} false
  Skills:
  - addtag{t=fly_animation} @self
  - potion{type=SPEED;duration=25;level=6;hasParticles=false} @self
  - delay 13
  - skill{s=Nocsy_Drakonin_Fly_effect}
  - skill{s=Nocsy_Drakonin_Sound_Flap} @self
  - delay 13
  - removetag{t=fly_animation} @self

Nocsy_Drakonin_Fly_effect:
  Conditions:
  - altitude{h=0to3} true
  Skills: []
  
#----------- Engage Land -----------#
Nocsy_Drakonin_FlyLand-Remount:
  Conditions:
  - ModelHasDriver{} true
  - hasowner{} true
  Skills:
  - skill{s=[
          - dismountmodel{p=mount} @self
          - delay 1
          - mountmodel{mode=flying} @Owner
          ]}
  
Nocsy_Drakonin_FlyLand:
  Conditions:
  - hastag{t=start_fly} false
  - hastag{t=fly} true
  - altitude{h=0to1.05} true
  - hastag{t=end_fly} false
  - hastag{t=plunge} false
  Skills:
  - addtag{t=end_fly} @self
  - state{s=fly_loop;remove=true} @self
  - state{s=fly_end;li=2;lo=2;speed=1.4} @self
  - setAI{ai=false} @self
  - delay 12
  - setAI{ai=true} @self
  - projectile{i=1;maxRange=2;v=0.05;md=5;hitRadius=0.1;sE=false;sb=true;hs=true;hfs=0.01;
      onTick=[
              - pull{velocity=7;to=true} @Self
             ];
      onEnd=[
              - particle{
                         a=1;
                         s=0.6;
                         particle=explosion_normal;
                         amount=1;
                         d=true;
                        } @Ring{r=4;points=20;yOffset=0.1;}
              - sound{s=entity.horse.breathe;v=2;p=0.8} @self
            ];} @Forward{f=4;y=-20}
  - skill{s=Nocsy_Drakonin_FlyLand-Remount}
  - delay 20
  - setAI{ai=true} @self
  - removetag{t=fly} @self
  - removetag{t=end_fly} @self

#----------- Animate Plunge -----------#
Nocsy_Drakonin_Animate-Plunge_Start:
  Conditions:
  - hastag{t=fly} true
  - hastag{t=plunge} false
  Skills:
  - addtag{t=plunge} @self
  - state{s=plunge_start;li=0;lo=0} @self
  - setAI{ai=false} @self
  - delay 6
  - skill{s=Nocsy_Drakonin_Sound_Flap} @self
  - delay 6
  - state{s=plunge_loop;li=0;lo=0} @self
  - setAI{ai=true} @self
  - projectile{i=1;maxRange=200;v=14;md=2147483646;hitRadius=1;sE=false;sb=true;hs=false;hfs=0.01;
      onTick=[
        - pull{velocity=7;to=true} @Self
        - skill{s=Nocsy_Drakonin_Animate-Plunge}
        - sound{s=entity.horse.breathe;v=2;p=0.1} @self
      ];
      onEnd=[
        - skill{s=Nocsy_Drakonin_Animate-Plunge_Land}
        - throw{velocity=10;velocityY=3} @ENO{r=4;ignore=players,samefaction}
        ];
      } @SelfLocation{y=-200}
  
Nocsy_Drakonin_Animate-Plunge:
  Conditions:
  - hastag{t=plunge} true
  - altitude{h<=1.5} castInstead Nocsy_Drakonin_Animate-Plunge_Land
  - hastag{t=plunge_animate} false
  Skills:
  - addtag{t=plunge_animate} @self
  - setAI{ai=false} @self
  - delay 15
  - setAI{ai=true} @self
  - removetag{t=plunge_animate} @self

Nocsy_Drakonin_Animate-Plunge_Land:
  Conditions:
  - hastag{t=plunge} true
  Skills:
  - setAI{ai=true} @self
  - signal{s=PLUNGE_LAND} @self
  - state{s=fly_loop;remove=true} @self
  - state{s=plunge_loop;remove=true} @self
  - state{s=plunge_end;li=0;lo=0} @self
  - removetag{t=fly} @self
  - sound{s=entity.ender_dragon.flap;v=2;p=0.1} @self
  - projectile{i=1;maxRange=2;v=0.05;md=5;hitRadius=0.1;sE=false;sb=true;hs=true;hfs=0.01;
      onTick=[
        - pull{velocity=7;to=true} @Self
      ];} @SelfLocation{y=-10}
  - particle{
             a=1;
             s=1;
             particle=explosion_normal;
             amount=2;
             d=true;
            } @RingAroundOrigin{r=6;points=20;yOffset=-0.3;}
  - delay 10
  - skill{s=[
          - dismountmodel{p=mount} @self
          - delay 1
          - mountmodel{mode=flying} @Owner
          ]}
  - particle{
             a=1;
             s=0.8;
             particle=explosion_normal;
             amount=2;
             d=true;
            } @RingAroundOrigin{r=3;points=20;yOffset=-0.3;}
  - delay 20
  - removetag{t=plunge} @self
  - setAI{ai=true} @self

#----------- Remove -----------#
Nocsy_Drakonin-Wyverns_Despawn:
  Skills:
  - defaultstate{t=death;s=null} @self
  - partvisibility{p=body;v=false} @self
  - delay 1
  - remove @self
Nocsy_Drakonin-Dragons_Despawn:
  Skills:
  - defaultstate{t=death;s=null} @self
  - partvisibility{p=body;v=false} @self
  - delay 1
  - remove @self
Nocsy_Drakonin_Despawn:
  Skills:
  - defaultstate{t=death;s=null} @self
  - partvisibility{p=body;v=false} @self
  - delay 1
  - remove @self
Nocsy_Drakonin_Death:
  Skills:
  - defaultstate{t=death;s=death_animation} @self

#----------- Sounds (Attack/Hurt/etc...) -----------#
Nocsy_Drakonin_Sound_Attack:
  Conditions:
  - hastag{t=sound} false
  Skills:
  - addtag{t=sound} @self
  - sound{s=entity.ravager.roar;v=0.3;p=0.5} @self
  - delay 40
  - removetag{t=sound} @self
Nocsy_Drakonin_Sound_Hurt:
  Conditions:
  - hastag{t=sound} false
  Skills:
  - addtag{t=sound} @self
  - sound{s=entity.ravager.hurt;v=1;p=0.3}
  - delay 40
  - removetag{t=sound} @self
Nocsy_Drakonin_Sound_Death:
  Skills:
  - sound{s=entity.ender_dragon.ambient;v=1.2;p=0.1} @self
Nocsy_Drakonin_Sound_Ambient:
  Skills:
  - Aura{auraName=Nocsy_Drakonin_Sound_Ambient-Aura;onTick=Nocsy_Drakonin_Sound_Ambient-Play;interval=300;d=2147483646} @self
  - Aura{auraName=Nocsy_Drakonin_Sound_Ambient-Move-Aura;onTick=Nocsy_Drakonin_Sound_Ambient-Move-Play;interval=5;d=2147483646} @self
Nocsy_Drakonin_Sound_Ambient-Move-Play:
  Conditions:
  - hastag{t=sound_move} false
  - hastag{t=fly} false
  - isMoving{} true
  Skills:
  - addtag{t=sound_move} @self
  - sound{s=entity.polar_bear.step;v=0.3;p=1} @self
  - delay 10
  - removetag{t=sound_move} @self
Nocsy_Drakonin_Sound_Ambient-Play:
  Conditions:
  - hastag{t=sound} false
  Skills:
  - addtag{t=sound} @self
  - sound{s=entity.zombie_horse.ambient;v=1;p=0.8} @self
  - delay 40
  - removetag{t=sound} @self
Nocsy_Drakonin_Sound_Mount:
  Skills:
  - sound{s=entity.horse.saddle;v=1;p=0.3}
Nocsy_Drakonin_Baby_Sound_Hurt:
  Conditions:
  - hastag{t=sound} false
  Skills:
  - addtag{t=sound} @self
  - sound{s=entity.silverfish.hurt;v=1;p=0.3}
  - delay 40
  - removetag{t=sound} @self
Nocsy_Drakonin_Baby_Sound_Death:
  Skills:
  - sound{s=entity.silverfish.death;v=1;p=0.3} @self
Nocsy_Drakonin_Baby_Sound_Ambient:
  Skills:
  - Aura{auraName=Nocsy_Drakonin_Baby_Sound_Ambient-Aura;onTick=Nocsy_Drakonin_Baby_Sound_Ambient-Play;interval=250;d=2147483646} @self
Nocsy_Drakonin_Baby_Sound_Ambient-Play:
  Conditions:
  - hastag{t=sound} false
  Skills:
  - addtag{t=sound} @self
  - sound{s=entity.silverfish.ambient;v=0.4;p=0.3} @self
  - delay 40
  - removetag{t=sound} @self
Nocsy_Drakonin_Baby_Sound_Flap:
  Skills:
  - sound{s=entity.phantom.flap;v=1.0;p=1.8} @self
Nocsy_Drakonin_Sound_Flap:
  Skills:
  - sound{s=entity.ender_dragon.flap;v=0.8;p=0.5} @self
Nocsy_Drakonin_Sound_Feed:
  Skills:
  - sound{s=entity.fox.eat;v=1;p=0.6}

#----------- Mount -----------#
Nocsy_Drakonin_Owner:
  Conditions:
  - hasOwner{} false
  - ModelHasDriver false
  Skills:
  - setOwner{} @trigger

Nocsy_Drakonin_Mount:
  Skills:
  - skill{s=Nocsy_Drakonin_Owner}
  - skill{s=Nocsy_Drakonin_Mount_Owner} @trigger

Nocsy_Drakonin_Mount_Owner:
  Conditions:
  - hasowner{} castInstead Nocsy_Drakonin_Mount_Owner-MCPets
  Skills:
  - skill{s=Nocsy_Drakonin_Sound_Mount} @self
  - mountmodel{mode=walking}

Nocsy_Drakonin_Mount_Owner-MCPets:
  Conditions:
  - owner{} true
  Skills:
  - skill{s=Nocsy_Drakonin_Sound_Mount} @self
  - mountmodel{mode=walking}
#----------- AI/Behavior -----------#
Nocsy_Drakonin_AI:
  Skills:
  - Aura{auraName=Nocsy_Drakonin_AI-Aura;onTick=Nocsy_Drakonin_AI-Tick;interval=1;d=2147483646} @self

Nocsy_Drakonin_Threat_Owner:
  Conditions:
  - hasowner{} true
  - hastag{t=owner_marked} false
  Skills:
  - addtag{t=owner_marked} @self
  - threat{amount=1000000} @Owner

Nocsy_Drakonin_AI-Tick:
  Conditions:
  - hastag{t=flee} false
  - targetwithin{d=3} castinstead Nocsy_Drakonin_AI-Stop
  - hastag{t=come} castinstead Nocsy_Drakonin_AI-Tick-Walk
  Skills:
  - addtag{t=come} @self
  - skill{s=Nocsy_Drakonin_Threat_Owner}
  - removetag{t=stop} @self
  - removetag{t=idle} @self
  - runaigoalselector{goal=clear}
  - runaigoalselector{goal=meleeattack}
  - runaigoalselector{goal=randomstroll}
Nocsy_Drakonin_AI-Tick-Walk: # Drakonin walk
  Conditions:
  - hastag{t=come} true
  - hastag{t=fly} castInstead Nocsy_Drakonin_AI-Tick-Fly
  - moving{} true
  - hastag{t=walk} false
  - hastag{t=water} castinstead Nocsy_Drakonin_AI-Tick-Walk-Wyvern
  - hastag{t=cloud} castinstead Nocsy_Drakonin_AI-Tick-Walk-Wyvern
  - hastag{t=poison} castinstead Nocsy_Drakonin_AI-Tick-Walk-Wyvern
  - hastag{t=night} castinstead Nocsy_Drakonin_AI-Tick-Walk-Wyvern
  Skills:
  - state{s=idle_loop;remove=true;} @self
  - state{s=walk_loop;li=0;lo=0;speed=1.8} @self
  - addtag{t=walk} @self
  - delay 11
  - removetag{t=walk} @self
Nocsy_Drakonin_AI-Tick-Walk-Wyvern: # Wyvern walk
  Conditions:
  - hastag{t=come} true
  - hastag{t=walk} false
  - hastag{t=water} castinstead
  Skills:
  - state{s=idle_loop;remove=true;} @self
  - state{s=walk_loop;li=0;lo=0;speed=1.75} @self
  - addtag{t=walk} @self
  - delay 17
  - removetag{t=walk} @self
Nocsy_Drakonin_AI-Tick-Fly:
  Conditions:
  - hastag{t=fly} true
  - hastag{t=fly_animate} false
  Skills:
  - state{s=fly_loop;remove=true} @self
  - state{s=fly_loop;li=0;lo=0;speed=1.3} @self
  - addtag{t=fly_animate} @self
  - skill{s=[
            - delay 10
            - skill{s=Nocsy_Drakonin_Baby_Sound_Flap}
            ]} @self
  - potion{type=SPEED;duration=25;level=1;hasParticles=false} @self
  - delay 20
  - removetag{t=fly_animate} @self
Nocsy_Drakonin_AI-Stop:
  Skills:
  - addtag{t=stop} @self
  - skill{s=[
            - potion{type=SLOW;duration=5;lvl=126;hasParticles=false} @self
            ];repeat=5;repeatInterval=1} @self
  - skill{s=Nocsy_Drakonin_AI-Stop-Loop;repeat=20;repeatInterval=1}
  - removetag{t=come} @self
  - runaigoalselector{goal=clear}
  - runaigoalselector{goal=meleeattack}
  - runaigoalselector{goal=randomstroll}
  - skill{s=Nocsy_Drakonin_AI-Stop-IdleLoop}
Nocsy_Drakonin_AI-Stop-Loop:
  Conditions:
  - hastag{t=idle} true
  - hastag{t=come} false
  Skills:
  - potion{type=SLOW;duration=15;lvl=126;hasParticles=false} @self
Nocsy_Drakonin_AI-Stop-IdleLoop:
  Conditions:
  - hastag{t=idle} false
  - hastag{t=fly} castInstead Nocsy_Drakonin_AI-Stop-Fly
  Skills:
  - state{s=walk_loop;remove=true;} @self
  - state{s=idle_loop;li=0;lo=0;speed=1} @self
  - skill{s=Nocsy_Drakonin_AI-Stop-Loop;repeat=50;repeatInterval=1}
  - addtag{t=idle} @self
  - delay 38
  - removetag{t=idle} @self
Nocsy_Drakonin_AI-Stop-Fly:
  Conditions:
  - hastag{t=fly} true
  - hastag{t=fly_animate} false
  Skills:
  - skill{s=Nocsy_Drakonin_AI-Stop-Loop;repeat=20;repeatInterval=1}
  - state{s=fly_loop;remove=true} @self
  - state{s=fly_loop;li=0;lo=0;speed=1.3} @self
  - addtag{t=idle} @self
  - addtag{t=fly_animate} @self
  - skill{s=[
            - delay 10
            - skill{s=Nocsy_Drakonin_Baby_Sound_Flap}
            ]} @self
  - delay 19
  - removetag{t=fly_animate} @self
  - removetag{t=idle} @self
Nocsy_Drakonin_AI-Flee:
  Conditions:
  - hastag{t=flee} false
  Skills:
  - addtag{t=flee} @self
  - removetag{t=come} @self
  - removetag{t=stop} @self
  - removetag{t=idle} @self
  - runaigoalselector{goal=clear}
  - runaigoalselector{goal=fleeplayers}

#----------- Interact -----------#
Nocsy_Drakonin_Interact:
  Skills:
  - delay 3
  - skill{s=Nocsy_Drakonin_Interact-Skill}
  
Nocsy_Drakonin_Interact-Skill:
  Conditions:
  - hastag{t=feeding} false
  - hastag{t=interacted} false
  - hastag{t=fly} castInstead Nocsy_Drakonin_Interact-Land
  Skills:
  - addtag{t=interacted} @self
  - addtag{t=fly} @self
  - addtag{t=fly_animate} @self
  - state{s=walk_loop;remove=true} @self
  - state{s=fly_start;li=0;lo=0;speed=1.75} @self
  - skill{s=[
            - delay 10
            - skill{s=Nocsy_Drakonin_Baby_Sound_Flap}
            ]} @self
  - delay 23
  - removetag{t=fly_animate} @self
  - removetag{t=interacted} @self
  - state{s=fly_loop;li=0;lo=0;speed=1.75} @self
  
Nocsy_Drakonin_Interact-Land:
  Skills:
  - addtag{t=interacted} @self
  - addtag{t=fly_animate} @self
  - removetag{t=fly} @self
  - state{s=fly_loop;remove=true} @self
  - state{s=fly_end;li=0;lo=0;speed=1.75} @self
  - delay 23
  - removetag{t=interacted} @self
  - removetag{t=fly_animate} @self
  - state{s=idle_loop;li=0;lo=0;speed=1.75} @self
  
#----------- Feeding -----------#
Nocsy_Drakonin_Variable:
  Skills:
  - setvariable{var=caster.tame;value=0;s=CASTER} @self
  
Nocsy_Drakonin_PlayerTame_Init:
  Conditions:
  - hasowner{} false
  Skills:
  - sudoskill{s=Nocsy_Drakonin_PlayerTame;cat=true} @trigger
  
Nocsy_Drakonin_PlayerTame:
  Conditions:
  - holding{m=GOLDEN_APPLE} true
  Skills:
  - consumeHeldItem{amount=1} @self
  # If consumeHeldItem does not work for you, try using consumeUsedItem{amount=1}
  - sudoskill{s=Nocsy_Drakonin_Tame;cat=true} @trigger
  
Nocsy_Drakonin_Tame:
  Conditions:
  - hastag{t=feeding} false
  - variableEquals{var=caster.tame;value=5} castInstead Nocsy_Drakonin_Transform_init
  Skills:
  - skill{s=Nocsy_Drakonin_Interact_Feed} @self
  - skill{s=Nocsy_Drakonin_Sound_Feed} @self
  - variableadd{var=caster.tame;amount=1} @self
  - skill{s=Nocsy_Drakonin_Transform_init}
  - effect:particles{p=heart;amount=3;speed=0.1;hS=0.15;vS=0.05} @SelfLocation{y=1.1}
Nocsy_Drakonin_Interact_Feed:
  Conditions:
  - hastag{t=feeding} false
  Skills:
  - addtag{t=feeding} @self
  - delay 5
  - removetag{t=feeding} @self

Nocsy_Drakonin_Transform_init:
  Conditions:
  - variableEquals{var=caster.tame;value=5}
  Skills:
  - setowner @target
  - effect:particles{p=heart;amount=3;speed=0.1;hS=0.15;vS=0.05} @SelfLocation{y=1.1}
  - setAI{ai=false} @self
  - sound{s=entity.illusioner.prepare_mirror;v=1;p=0.3} @self
  - particle{
            a=1;
            s=0.5;
            particle=FIREWORKS_SPARK;
            amount=1;
            d=true;
            dir=0,1.2,0;
            repeat=5;
            repeatInterval=5;
            } @RingAroundOrigin{r=2;points=10;yOffset=1.5;rx=3.14}
  - particle{
            a=1;
            s=0.6;
            particle=SPELL_WITCH;
            amount=1;
            d=true;
            dir=0,1.2,0;
            repeat=5;
            repeatInterval=8;
            delay=3;
            } @RingAroundOrigin{r=2;points=20;yOffset=1.5;rx=3.14}
  - particle{
            a=1;
            s=0.5;
            particle=FIREWORKS_SPARK;
            amount=1;
            d=true;
            dir=0,1.2,0;
            repeat=5;
            repeatInterval=10;
            delay=8;
            } @RingAroundOrigin{r=3;points=30;yOffset=1.5;rx=3.14}
  - delay 30
  - sound{s=entity.illusioner.cast_spell;v=1;p=0.3} @self
  - skill{s=Nocsy_Drakonin_Transform} @self
  - partvisibility{p=body;v=false} @self
  - submodel{part=body;r=true} @self
  - effect:particles{p=explosion_huge;amount=2;speed=0.1;hS=0.05;vS=0.05} @SelfLocation{y=1}
  - delay 5
  - signal{s=MCPETS} @LivingEntitiesInRadius{r=3}
  - skill{s=Nocsy_Drakonin_Despawn} @self
Nocsy_Drakonin_Interact_Happy:
  Conditions:
  - hastag{t=animate} false
  Skills:
  - addtag{t=animate} @self
  - state{s=happy;li=0;lo=0;speed=1} @self
  - setAI{ai=false} @self
  - delay 0 #VALUE
  - setAI{ai=true} @self
  - removetag{t=animate} @self

Nocsy_Drakonin_Transform:
  Conditions:
  - hastag{t=fire} castInstead Nocsy_Drakonin_Transform-Fire
  - hastag{t=dark} castInstead Nocsy_Drakonin_Transform-Dark
  - hastag{t=water} castInstead Nocsy_Drakonin_Transform-Water
  - hastag{t=cloud} castInstead Nocsy_Drakonin_Transform-Cloud
  - hastag{t=volcanic} castInstead Nocsy_Drakonin_Transform-Volcanic
  - hastag{t=poison} castInstead Nocsy_Drakonin_Transform-Poison
  - hastag{t=forest} castInstead Nocsy_Drakonin_Transform-Forest
  - hastag{t=night} castInstead Nocsy_Drakonin_Transform-Night
  Skills:
  - remove @self

Nocsy_Drakonin_Transform-Fire:
  Skills:
  - sudoskill{s=[
                - summon{type=Nocsy_Drakonin-Fire-Adult;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;sio=true} @trigger
                ];cat=true} @target
  # Add the permission node to the player here to access the pet
  #- command{c="lp user <target.name> permission set mcpets.nocsy_drakonin.fire"} @target
Nocsy_Drakonin_Transform-Dark:
  Skills:
  - sudoskill{s=[
                - summon{type=Nocsy_Drakonin-Dark-Adult;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;sio=true} @trigger
                ];cat=true} @target
  # Add the permission node to the player here to access the pet
  #- command{c="lp user <target.name> permission set mcpets.nocsy_drakonin.dark"} @target
Nocsy_Drakonin_Transform-Water:
  Skills:
  - sudoskill{s=[
                - summon{type=Nocsy_Drakonin-Water-Adult;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;sio=true} @trigger
                ];cat=true} @target
  # Add the permission node to the player here to access the pet
  #- command{c="lp user <target.name> permission set mcpets.nocsy_drakonin.water"} @target
Nocsy_Drakonin_Transform-Cloud:
  Skills:
  - sudoskill{s=[
                - summon{type=Nocsy_Drakonin-Cloud-Adult;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;sio=true} @trigger
                ];cat=true} @target
  # Add the permission node to the player here to access the pet
  #- command{c="lp user <target.name> permission set mcpets.nocsy_drakonin.cloud"} @target
Nocsy_Drakonin_Transform-Volcanic:
  Skills:
  - sudoskill{s=[
                - summon{type=Nocsy_Drakonin-Volcanic-Adult;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;sio=true} @trigger
                ];cat=true} @target
  # Add the permission node to the player here to access the pet
  #- command{c="lp user <target.name> permission set mcpets.nocsy_drakonin.volcanic"} @target
Nocsy_Drakonin_Transform-Poison:
  Skills:
  - sudoskill{s=[
                - summon{type=Nocsy_Drakonin-Poison-Adult;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;sio=true} @trigger
                ];cat=true} @target
  # Add the permission node to the player here to access the pet
  #- command{c="lp user <target.name> permission set mcpets.nocsy_drakonin.poison"} @target
Nocsy_Drakonin_Transform-Forest:
  Skills:
  - sudoskill{s=[
                - summon{type=Nocsy_Drakonin-Forest-Adult;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;sio=true} @trigger
                ];cat=true} @target
  # Add the permission node to the player here to access the pet
  #- command{c="lp user <target.name> permission set mcpets.nocsy_drakonin.forest"} @target
Nocsy_Drakonin_Transform-Night:
  Skills:
  - sudoskill{s=[
                - summon{type=Nocsy_Drakonin-Night-Adult;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;sio=true} @trigger
                ];cat=true} @target
  # Add the permission node to the player here to access the pet
  #- command{c="lp user <target.name> permission set mcpets.nocsy_drakonin.night"} @target

Nocsy_Drakonin_MCPets:
  Conditions:
  - hastag{t=fire} castInstead Nocsy_Drakonin_MCPets-Fire
  - hastag{t=dark} castInstead Nocsy_Drakonin_MCPets-Dark
  - hastag{t=water} castInstead Nocsy_Drakonin_MCPets-Water
  - hastag{t=cloud} castInstead Nocsy_Drakonin_MCPets-Cloud
  - hastag{t=volcanic} castInstead Nocsy_Drakonin_MCPets-Volcanic
  - hastag{t=poison} castInstead Nocsy_Drakonin_MCPets-Poison
  - hastag{t=forest} castInstead Nocsy_Drakonin_MCPets-Forest
  - hastag{t=night} castInstead Nocsy_Drakonin_MCPets-Night
  Skills: []
 
Nocsy_Drakonin_MCPets-Fire:
  Skills:
  - setpet{id=Nocsy_Drakonin-Fire;permCheck=true} @owner
Nocsy_Drakonin_MCPets-Dark:
  Skills:
  - setpet{id=Nocsy_Drakonin-Dark;permCheck=true} @owner
Nocsy_Drakonin_MCPets-Water:
  Skills:
  - setpet{id=Nocsy_Drakonin-Water;permCheck=true} @owner
Nocsy_Drakonin_MCPets-Cloud:
  Skills:
  - setpet{id=Nocsy_Drakonin-Cloud;permCheck=true} @owner
Nocsy_Drakonin_MCPets-Volcanic:
  Skills:
  - setpet{id=Nocsy_Drakonin-Volcanic;permCheck=true} @owner
Nocsy_Drakonin_MCPets-Poison:
  Skills:
  - setpet{id=Nocsy_Drakonin-Poison;permCheck=true} @owner
Nocsy_Drakonin_MCPets-Forest:
  Skills:
  - setpet{id=Nocsy_Drakonin-Forest;permCheck=true} @owner
Nocsy_Drakonin_MCPets-Night:
  Skills:
  - setpet{id=Nocsy_Drakonin-Night;permCheck=true} @owner

#----------- CancelEvent -----------#
Nocsy_Drakonin_CancelEvent:
  Skills:
  - CancelEvent

############################################
#              Fire Drakonin               #
############################################

#----------- Spell -----------#
Nocsy_Drakonin_Spell-Fire:
  Conditions:
  - hastag{t=spell} false
  Skills:
  - addtag{t=spell} @self
  - setAI{ai=false} @self
  - skill{s=Nocsy_Drakonin_Spell-Fire-Ground} @self
  

Nocsy_Drakonin_Spell-Fire-Ground:
  Conditions:
  - hastag{t=fly} castInstead Nocsy_Drakonin_Spell-Fire-Air
  Skills:
  - #SPELL : fire orbs shooting fire missiles
  - #SUMMON THE SPELL EFFECT
  - #EFFECT
  - state{s=spell_ground;li=0;lo=0} @self
  - setAI{ai=false} @self
  - skill{s=[
            - delay 10
            - skill{s=Nocsy_Drakonin_Sound_Attack}
            ]} @self
  - delay 28
  - sound{s=block.fire.extinguish;v=1;p=1.6} @self
  - summon{type=Nocsy_Drakonin-Fire-Spell;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;inheritFaction=true} @Ring{radius=4.5;points=3;yOffset=0.1}
  - delay 9
  - setAI{ai=true} @self
  - removetag{t=spell} @self
Nocsy_Drakonin_Spell-Fire-Missile:
  Skills:
  - sound{s=block.fire.ambient;v=1;p=1.6} @self
  - missile{
          ot=[
            - skill{s=[
                - particle{
                           a=1;
                           s=0.1;
                           particle=flame;
                           amount=2;
                           d=true;
                           fromOrigin=true;
                           } @RingAroundOrigin{r=4;points=20;yOffset=0;rx=0.7}
              ]}
            - skill{delay=6;s=[ 
                - throw{v=6;vy=1;fromOrigin=true}
                - damage{amount=10}
              ]} @ENO{r=4;ignore=players,samefaction}
          ];
          oh=[
            - skill{delay=6;s=[
                - ignite{ticks=100}
                - throw{v=6;vy=1;fromOrigin=true}
                - damage{amount=10}
                - sound{s=block.fire.extinguish;v=1;p=0.6}
                - particle{
                           a=1;
                           s=0.4;
                           particle=flame;
                           amount=30;
                           d=true;
                           dir=0,1,0;
                           fromOrigin=true;
                           }
              ]} @ENO{r=4;ignore=players,samefaction}
          ];
          v=8;
          i=1;
          hR=1;
          vR=1;
          in=0.75}
  
Nocsy_Drakonin_Spell-Fire-Air:
  Skills:
  - state{s=spell_air;li=0;lo=0} @self
  - setAI{ai=false} @self
  - skill{s=[
            - delay 8
            - skill{s=Nocsy_Drakonin_Sound_Flap}
            ]} @self
  - delay 13
  - sound{s=block.fire.extinguish;v=1;p=1.6} @self
  - summon{type=Nocsy_Drakonin-Fire-Spell;amount=1;radius=0;os=false;yRadiusUpOnly=true;yRadius=0;inheritFaction=true} @Ring{radius=4.5;points=3;yOffset=0.1}
  - delay 21
  - setAI{ai=true} @self
  - removetag{t=spell} @self

############################################
#              Dark Drakonin               #
############################################

#----------- Spell -----------#
Nocsy_Drakonin_Spell-Dark:
  Conditions:
  - hastag{t=spell} false
  Skills:
  - addtag{t=spell} @self
  - setAI{ai=false} @self
  - skill{s=Nocsy_Drakonin_Spell-Dark-Ground} @self
  

Nocsy_Drakonin_Spell-Dark-Ground:
  Conditions:
  - hastag{t=fly} castInstead Nocsy_Drakonin_Spell-Dark-Air
  Skills:
  - #SPELL : shadow meteors
  - state{s=spell_ground;li=0;lo=0} @self
  - setAI{ai=false} @self
  - skill{s=[
            - delay 10
            - skill{s=Nocsy_Drakonin_Sound_Attack}
            ]} @self
  - delay 28
  - sound{s=entity.evoker.cast_spell;v=1;p=1.6} @self
  - skill{s=Nocsy_Drakonin_Spell-Dark-Meteor} @RLNTE{a=4;r=20;s=2;minr=4.5}
  - sound{s=entity.evoker.prepare_attack;v=0.6;p=0.6} 
  - delay 9
  - setAI{ai=true} @self
  - removetag{t=spell} @self

Nocsy_Drakonin_Spell-Dark-Meteor:
  Skills:
  - projectile{
        bulletType=MOB;
        mob=Nocsy_Drakonin-Dark-Spell;
        StartYOffset=20;
        onTick=[
          - skill{s=Nocsy_Drakonin_Spell-Dark-Meteor_Effect}
        ];
        onHit=[
          - throw{v=3;vy=4;fromOrigin=true} @ENO{r=5;ignore=players,samefaction} 
          - damage{a=12} @ENO{r=5;ignore=players,samefaction} 
          - particle{
                  a=1;
                  s=0.8;
                  particle=SQUID_INK;
                  amount=2;
                  d=true;
                  fromOrigin=true;
            } @RingAroundOrigin{r=1;points=15;yOffset=1;rx=3.14}
        ];
        onEnd=[
          - throw{v=3;vy=4;fromOrigin=true} @ENO{r=5;ignore=players,samefaction} 
          - damage{a=12} @ENO{r=5;ignore=players,samefaction}
          - sound{s=entity.evoker.cast_spell;v=1;p=0.4} @self        
          - particle{
                  a=1;
                  s=0.8;
                  particle=SQUID_INK;
                  amount=2;
                  d=true;
                  fromOrigin=true;
            } @RingAroundOrigin{r=1;points=15;yOffset=1;rx=3.14}
        ];
        type=NORMAL;
        i=1;
        hRadius=1.5;
        vRadius=1.5;
        v=7;
        g=1;
        hp=false;
        hnp=true;
        sE=true;
        sB=true;
    }
Nocsy_Drakonin_Spell-Dark-Meteor_Effect:
  Skills:
  - particle{
                  a=1;
                  s=0.2;
                  particle=SQUID_INK;
                  amount=1;
                  d=true;
                  fromOrigin=true;
            } @RingAroundOrigin{r=2;points=3;yOffset=0;rx=-0.785398}
Nocsy_Drakonin_Spell-Dark-Air:
  Skills:
  - #SPELL : shadow meteors
  - state{s=spell_air;li=0;lo=0} @self
  - setAI{ai=false} @self
  - skill{s=[
            - delay 8
            - skill{s=Nocsy_Drakonin_Sound_Flap}
            ]} @self
  - delay 13
  - sound{s=entity.evoker.prepare_attack;v=0.6;p=0.6} @self
  - skill{s=Nocsy_Drakonin_Spell-Dark-Meteor} @RLNTE{a=4;r=20;s=2;minr=4.5}
  - delay 21
  - setAI{ai=true} @self
  - removetag{t=spell} @self

############################################
#              Water Wyvern                #
############################################

#----------- Spell -----------#
Nocsy_Drakonin_Spell-Water:
  Conditions:
  - hastag{t=spell} false
  Skills:
  - addtag{t=spell} @self
  - setAI{ai=false} @self
  - skill{s=Nocsy_Drakonin_Spell-Water-Ground} @self
  

Nocsy_Drakonin_Spell-Water-Ground:
  Conditions:
  - hastag{t=fly} castInstead Nocsy_Drakonin_Spell-Water-Air
  Skills:
  - #SPELL : water emerging from the ground, pushing ennemies in the air
  - state{s=spell_ground;li=0;lo=0} @self
  - setAI{ai=false} @self
  - skill{s=[
            - delay 10
            - skill{s=Nocsy_Drakonin_Sound_Attack}
            ]} @self
  - delay 28
  - sound{s=ambient.underwater.enter;v=1;p=0.2} @self
  - skill{s=[
              - skill{s=Nocsy_Drakonin_Spell-Water_Geyser} @Ring{radius=3;points=4;}
              - skill{s=[
                        - delay 15
                        - sound{s=ambient.underwater.enter;v=1;p=1}
                        ]} @self
              - delay 7
              - skill{s=Nocsy_Drakonin_Spell-Water_Geyser} @Ring{radius=6;points=8;}
              - skill{s=[
                        - delay 15
                        - sound{s=ambient.underwater.enter;v=1;p=1}
                        ]} @self 
            ]}
  - delay 9
  - setAI{ai=true} @self
  - delay 20
  - removetag{t=spell} @self

Nocsy_Drakonin_Spell-Water_Geyser:
  Skills:
  - particles{
        particle=Falling_Water;
        amount=10;
        speed=1;
        d=true;
        dir=0,1,0;
        repeat=4;
        repeatInterval=5;}
  - delay 10
  - particles{
        particle=Falling_Water;
        amount=20;
        speed=2;
        d=true;
        dir=0,5,0;
        repeat=4;
        repeatInterval=5;}
  - summon{type=Nocsy_Drakonin-Water-Spell;amount=1;radius=0;onSurface=true;inheritFaction=true}
  - delay 10
   
Nocsy_Drakonin_Spell-Water-Air:
  Skills:
  - #SPELL : water spin/typhoon
  - skill{s=[
            - delay 8
            - skill{s=Nocsy_Drakonin_Sound_Flap}
            ]} @self
  - skill{s=Nocsy_Drakonin_Animate-Plunge_Start} @self

Nocsy_Drakonin_Spell-Water-Plunge:
  Skills:
  - skill{s=[
              - skill{s=Nocsy_Drakonin_Spell-Water_Geyser} @Ring{radius=3;points=4;}
              - skill{s=[
                        - delay 15
                        - sound{s=ambient.underwater.enter;v=1;p=1}
                        ]} @self
              - delay 7
              - skill{s=Nocsy_Drakonin_Spell-Water_Geyser} @Ring{radius=6;points=8;} 
              - skill{s=[
                        - delay 15
                        - sound{s=ambient.underwater.enter;v=1;p=1}
                        ]} @self
            ]}
  - delay 20
  - removetag{t=spell} @self

############################################
#             Cloud Wyvern                 #
############################################

#----------- Spell -----------#
Nocsy_Drakonin_Spell-Cloud:
  Conditions:
  - hastag{t=spell} false
  Skills:
  - addtag{t=spell} @self
  - setAI{ai=false} @self
  - skill{s=Nocsy_Drakonin_Spell-Cloud-Ground} @self
  

Nocsy_Drakonin_Spell-Cloud-Ground:
  Conditions:
  - hastag{t=fly} castInstead Nocsy_Drakonin_Spell-Cloud-Air
  Skills:
  - #SPELL : tornado pushing ennemies away
  - state{s=spell_ground;li=0;lo=0} @self
  - setAI{ai=false} @self
  - skill{s=[
            - delay 10
            - skill{s=Nocsy_Drakonin_Sound_Attack}
            ]} @self
  - delay 28
  - sound{s=entity.phantom.flap;v=1.5;p=0.6} @self
  - skill{s=Nocsy_Drakonin_Spell-Wind_Tornado-Ground} @Forward{f=5;y=0.5;sideOffset=-1.5}
  - skill{s=Nocsy_Drakonin_Spell-Wind_Tornado-Ground} @Forward{f=5;y=0.5;sideOffset=1.5}
  - delay 9
  - setAI{ai=true} @self
  - removetag{t=spell} @self
  
Nocsy_Drakonin_Spell-Wind-Sound:
  Conditions:
  - hastag{t=air_sound} false
  Skills:
  - addtag{t=air_sound} @self
  - sound{s=entity.phantom.flap;v=1.5;p=0.6}
  - delay 10
  - removetag{t=air_sound} @self

Nocsy_Drakonin_Spell-Wind_Tornado-Ground:
  Skills:
  - projectile{
    bulletType=MOB;
    mob=Nocsy_Drakonin-Cloud-Spell;
    onTick=[
      - skill{s=Nocsy_Drakonin_Spell-Wind-Tornado_Effect}
      - throw{v=0.5;vy=16;fromOrigin=true} @ENO{r=3;ignore=players,samefaction} 
      - damage{a=10} @ENO{r=3;ignore=players,samefaction}
      - skill{s=Nocsy_Drakonin_Spell-Wind-Sound}
      - skill{s=[
              - particle{
                        a=1;
                        s=0.1;
                        particle=explosion_normal;
                        amount=1;
                        repeat=10;
                        repeatInterval=3;
                        } 
              ]
             } @ENO{r=3;ignore=players,samefaction}
    ];
    onHit=[];
    onEnd=[];
    i=1;
    hRadius=2.5;
    vRadius=4.5;
    v=8;
    hp=false;
    hnp=true;
    sE=false;
    hS=true;
    hfs=1;
    }
Nocsy_Drakonin_Spell-Wind_Tornado-Air:
  Skills:
  - projectile{
    bulletType=MOB;
    mob=Nocsy_Drakonin-Cloud-Spell;
    onTick=[
      - skill{s=Nocsy_Drakonin_Spell-Wind-Tornado_Effect}
      - throw{v=0.5;vy=16;fromOrigin=true} @ENO{r=3;ignore=players,samefaction} 
      - damage{a=10} @ENO{r=3;ignore=players,samefaction}
      - skill{s=Nocsy_Drakonin_Spell-Wind-Sound}
      - skill{s=[
              - particle{
                        a=1;
                        s=0.1;
                        particle=explosion_normal;
                        amount=1;
                        repeat=10;
                        repeatInterval=3;
                        } 
              ]
             } @ENO{r=3;ignore=players,samefaction}
    ];
    onHit=[];
    onEnd=[];
    i=1;
    hRadius=2.5;
    vRadius=4.5;
    v=8;
    hp=false;
    hnp=true;
    sE=false;
    }

Nocsy_Drakonin_Spell-Wind-Tornado_Effect:
  Skills:
  - particles{
        particle=explosion_normal;
        amount=2;
        speed=0.5;
        d=true;
        fromOrigin=true;
        } @RingAroundOrigin{r=1;points=4;yOffset=0;rx=3.14159}
  - delay 10
  
Nocsy_Drakonin_Spell-Cloud-Air:
  Skills:
  - #SPELL : air twist
  - state{s=spell_air;li=0;lo=0} @self
  - setAI{ai=false} @self
  - skill{s=[
            - delay 8
            - skill{s=Nocsy_Drakonin_Sound_Flap}
            ]} @self
  - delay 13
  - sound{s=entity.phantom.flap;v=1.5;p=0.6} @self
  - skill{s=Nocsy_Drakonin_Spell-Wind_Tornado-Air} @Forward{f=5;y=0.5;sideOffset=-1.5}
  - skill{s=Nocsy_Drakonin_Spell-Wind_Tornado-Air} @Forward{f=5;y=0.5;sideOffset=1.5}
  - delay 21 
  - setAI{ai=true} @self
  - removetag{t=spell} @self

############################################
#             Volcanic Drakonin            #
############################################

#----------- Spell -----------#
Nocsy_Drakonin_Spell-Volcanic:
  Conditions:
  - hastag{t=spell} false
  Skills:
  - addtag{t=spell} @self
  - setAI{ai=false} @self
  - skill{s=Nocsy_Drakonin_Spell-Volcanic-Ground} @self
  

Nocsy_Drakonin_Spell-Volcanic-Ground:
  Conditions:
  - hastag{t=fly} castInstead Nocsy_Drakonin_Spell-Volcanic-Air
  Skills:
  - #SPELL : volcan emerging from the ground, spitting lava projectiles
  - state{s=spell_ground;li=0;lo=0} @self
  - setAI{ai=false} @self
  - skill{s=[
            - delay 10
            - skill{s=Nocsy_Drakonin_Sound_Attack}
            ]} @self
  - delay 10
  - skill{s=Nocsy_Drakonin_Spell-Lava_Rocks} @RingAroundOrigin{radius=3;points=4;}
  - skill{s=Nocsy_Drakonin_Spell-Lava_Rocks} @RingAroundOrigin{radius=5;points=6;}
  - delay 18
  - sound{s=entity.ender_dragon.shoot;v=1;p=0.1} @self
  - delay 9
  - setAI{ai=true} @self
  - removetag{t=spell} @self

Nocsy_Drakonin_Spell-Lava_Rocks:
  Skills:
  - particles{
        particle=LAVA;
        amount=10;
        speed=1;
        d=true;
        fromOrigin=true;
        dir=0,1,0;
        repeat=4;
        repeatInterval=5;}
  - delay 20
  - summon{type=Nocsy_Drakonin-Volcanic-Spell;amount=1;radius=0;onSurface=true;inheritFaction=true}
  - delay 6
  - ignite{ticks=100} @ENO{r=2;ignore=players,samefaction}
  - damage{a=10} @ENO{r=2;ignore=players,samefaction}
  - throw{velocity=4;velocityY=5} @ENO{r=2;ignore=players,samefaction}

Nocsy_Drakonin_Spell-Lava_Rocks-Air:
  Skills:
  - particles{
        particle=LAVA;
        amount=10;
        speed=1;
        d=true;
        fromOrigin=true;
        dir=0,1,0;
        repeat=2;
        repeatInterval=2;}
  - delay 5
  - summon{type=Nocsy_Drakonin-Volcanic-Spell;amount=1;radius=0;onSurface=true;inheritFaction=true}

Nocsy_Drakonin_Spell-Volcanic-Air:
  Skills:
  - skill{s=[
            - delay 8
            - skill{s=Nocsy_Drakonin_Sound_Flap}
            ]} @self
  - skill{s=Nocsy_Drakonin_Animate-Plunge_Start} @self

Nocsy_Drakonin_Spell-Volcanic-Plunge:
  Skills:
  - skill{s=Nocsy_Drakonin_Spell-Lava_Rocks-Air} @RingAroundOrigin{radius=3;points=6;}
  - sound{s=entity.ender_dragon.shoot;v=0.5;p=0.1} @self
  - delay 10
  - skill{s=Nocsy_Drakonin_Spell-Lava_Rocks-Air} @RingAroundOrigin{radius=5;points=10}
  - sound{s=entity.ender_dragon.shoot;v=1;p=0.1} @self
  - delay 10
  - delay 10
  - removetag{t=spell} @self

############################################
#            Poison Drakonin               #
############################################

#----------- Spell -----------#
Nocsy_Drakonin_Spell-Poison:
  Conditions:
  - hastag{t=spell} false
  Skills:
  - addtag{t=spell} @self
  - setAI{ai=false} @self
  - skill{s=Nocsy_Drakonin_Spell-Poison-Ground} @self
  
Nocsy_Drakonin_Spell-Poison-Ground:
  Conditions:
  - hastag{t=fly} castInstead Nocsy_Drakonin_Spell-Poison-Air
  Skills:
  - #SPELL : poison clouds
  - state{s=spell_ground;li=0;lo=0} @self
  - setAI{ai=false} @self
  - skill{s=[
            - delay 10
            - skill{s=Nocsy_Drakonin_Sound_Attack}
            ]} @self
  - delay 28
  - sound{s=entity.illusioner.cast_spell;v=1;p=0.6} @self
  - skill{s=Nocsy_Drakonin_Spell-Poison_Lake} @ENO{r=15;sort=RANDOM;limit=4;ignore=players,samefaction}
  - skill{s=Nocsy_Drakonin_Spell-Poison_Lake} @RingAroundOrigin{radius=4;points=4;}
  - delay 9
  - setAI{ai=true} @self
  - removetag{t=spell} @self
  
Nocsy_Drakonin_Spell-Poison_Lake:
  Skills:
  - effect:particlering{
        particle=GLOW_SQUID_INK;
        points=6;
        r=2;
        amount=1;
        speed=0.5;
        d=true;
        dir=0,3,0;
        yOffset=1;
        repeat=3;
        repeatInterval=5;}
  - potion{type=SLOW;duration=20;lvl=3;hasParticles=false}
  - delay 15
  - summon{type=Nocsy_Drakonin-Poison-Spell;amount=1;radius=0;os=true;yRadiusUpOnly=true;yRadius=2;inheritFaction=true}

Nocsy_Drakonin_Spell-Poison-Air:
  Skills:
  - skill{s=[
            - delay 8
            - skill{s=Nocsy_Drakonin_Sound_Flap}
            ]} @self
  - skill{s=Nocsy_Drakonin_Animate-Plunge_Start} @self

Nocsy_Drakonin_Spell-Poison-Plunge:
  Skills:
  - sound{s=entity.illusioner.cast_spell;v=1;p=0.6} @self
  - skill{s=Nocsy_Drakonin_Spell-Poison_Lake} @ENO{r=20;sort=NEAREST;limit=5;ignore=players,samefaction}
  - delay 10
  - skill{s=Nocsy_Drakonin_Spell-Poison_Lake} @RingAroundOrigin{radius=4;points=4;}
  - delay 20
  - removetag{t=spell} @self

############################################
#            Forest Drakonin               #
############################################

#----------- Spell -----------#
Nocsy_Drakonin_Spell-Forest:
  Conditions:
  - hastag{t=spell} false
  Skills:
  - addtag{t=spell} @self
  - setAI{ai=false} @self
  - skill{s=Nocsy_Drakonin_Spell-Forest-Ground} @self
  

Nocsy_Drakonin_Spell-Forest-Ground:
  Conditions:
  - hastag{t=fly} castInstead Nocsy_Drakonin_Spell-Forest-Air
  Skills:
  - #SPELL : Roots emprisonning monsters around and make them suffocate
  - state{s=spell_ground;li=0;lo=0} @self
  - setAI{ai=false} @self
  - skill{s=[
            - delay 10
            - skill{s=Nocsy_Drakonin_Sound_Attack}
            ]} @self
  - delay 28
  - sound{s=block.grass.place;v=2;p=0.1} @self
  - sound{s=block.chest.open;v=1;p=0.1} @self
  - sound{s=block.chest.open;v=1;p=1.6} @self
  - skill{s=Nocsy_Drakonin_Spell-Forest_Roots} @ENO{r=20;sort=NEAREST;limit=5;ignore=players,samefaction}
  - skill{s=Nocsy_Drakonin_Spell-Forest_Roots} @RingAroundOrigin{radius=4;points=3;}
  - delay 9
  - setAI{ai=true} @self
  - removetag{t=spell} @self

Nocsy_Drakonin_Spell-Forest_Roots:
  Skills:
  - summon{type=Nocsy_Drakonin-Forest-Spell;amount=1;radius=0;os=true;yRadiusUpOnly=true;yRadius=2;inheritFaction=true}

Nocsy_Drakonin_Spell-Forest-Air:
  Skills:
  - skill{s=[
            - delay 8
            - skill{s=Nocsy_Drakonin_Sound_Flap}
            ]} @self
  - skill{s=Nocsy_Drakonin_Animate-Plunge_Start} @self

Nocsy_Drakonin_Spell-Forest-Plunge:
  Skills:
  - sound{s=block.grass.place;v=2;p=0.1} @self
  - sound{s=block.chest.open;v=1;p=0.1} @self
  - sound{s=block.chest.open;v=1;p=1.6} @self
  - skill{s=Nocsy_Drakonin_Spell-Forest_Roots} @RingAroundOrigin{radius=4;points=3;}
  - delay 10
  - skill{s=Nocsy_Drakonin_Spell-Forest_Roots} @ENO{r=20;sort=NEAREST;limit=5;ignore=players,samefaction}
  - delay 20
  - removetag{t=spell} @self

############################################
#              Night Wyvern                #
############################################

#----------- Spell -----------#
Nocsy_Drakonin_Spell-Night:
  Conditions:
  - hastag{t=spell} false
  Skills:
  - addtag{t=spell} @self
  - setAI{ai=false} @self
  - skill{s=Nocsy_Drakonin_Spell-Night-Ground} @self
  

Nocsy_Drakonin_Spell-Night-Ground:
  Conditions:
  - hastag{t=fly} castInstead Nocsy_Drakonin_Spell-Night-Air
  Skills:
  - #SPELL : star meteors
  - skill{s=Nocsy_Drakonin_StartFly-FORCE} @self
  - skill{s=[
            - delay 2
            - skill{s=Nocsy_Drakonin_Sound_Attack}
            ]} @self
  - delay 8
  - setAI{ai=true} @self
  - projectile{i=1;maxRange=2;v=2.4;md=30;hitRadius=2;sE=false;sb=true;hs=false;hfs=0.1;syo=0;sfo=0;
      onTick=[
        - pull{velocity=7;to=true} @Self
      ];
      } @Forward{f=2;y=3;sideOffset=0.0}
  - delay 21
  - state{s=dash_start;li=0;lo=0;speed=2} @self
  - setAI{ai=false} @self
  - delay 15
  - skill{s=Nocsy_Drakonin_Spell-Night_Dash}

Nocsy_Drakonin_Spell-Night_Dash:
  Skills:
  - setAI{ai=true} @self
  - addtag{t=spell_dash} @self
  - state{s=dash_loop;li=0;lo=0;speed=1.4} @self
  - skill{s=[
             - projectile{i=1;maxRange=80;v=40;md=400;hitRadius=2;sE=false;sb=true;hs=false;hfs=2;sfo=7;
                            onTick=[
                                    - skill{s=Nocsy_Drakonin_Spell-Dash-Animation-Effect}
                                    ];
              }
              - projectile{i=1;maxRange=80;v=40;md=400;hitRadius=2;sE=false;sb=true;hs=false;hfs=2;
                          onTick=[
                            - pull{velocity=7;to=true} @Self
                            - skill{s=Nocsy_Drakonin_Spell-Dash-Animation-Flap}
                            - skill{delay=6;s=[ 
                                - throw{v=20;vy=2;fromOrigin=true}
                                - damage{amount=10}
                              ]} @ENO{r=4;ignore=players,samefaction}
                          ];
                          onEnd=[
                            - skill{s=[
                                - damage{amount=10}
                                - throw{v=20;vy=3;fromOrigin=true}
                              ]} @ENO{r=2;ignore=players}
                            - setAI{ai=true} @self
                            - removetag{t=spell_dash} @self
                            - state{s=dash_loop;remove=true} @self
                            - state{s=dash_end;li=0;lo=0;speed=1.4} @self
                            - delay 23
                            - removetag{t=spell} @self
                          ]}
            ];} @Forward{f=100;y=0.1;sideOffset=0.0}

Nocsy_Drakonin_Spell-Dash-Animation-Effect:
  Conditions:
  - hastag{t=spell_dash} true
  - hastag{t=spell_dash_effect} false
  Skills:
  - addtag{t=spell_dash_effect} @self
  - particle{
            a=1;
            s=0.8;
            particle=explosion_normal;
            amount=1;
            d=true;
            } @Cone{angle=50;points=300;range=15;rotation=0;yoffset=1} #@Ring{r=4;points=40;yOffset=0.5;rx=1.78}
  - delay 3
  - removetag{t=spell_dash_effect} @self
  

Nocsy_Drakonin_Spell-Dash-Animation-Flap:
  Conditions:
  - hastag{t=spell_dash} true
  - hastag{t=spell_dash_animation} false
  Skills:
  - addtag{t=spell_dash_animation} @self
  - skill{s=[
            - delay 4
            - skill{s=Nocsy_Drakonin_Sound_Flap}
            ]} @self
  - delay 15
  - removetag{t=spell_dash_animation} @self

Nocsy_Drakonin_Spell-Night-Air:
  Skills:
  - skill{s=[
            - delay 2
            - skill{s=Nocsy_Drakonin_Sound_Attack}
            ]} @self
  - state{s=dash_start;li=0;lo=0;speed=1.4} @self
  - skill{s=[
            - delay 10
            - skill{s=Nocsy_Drakonin_Sound_Flap}
            ]} @self
  - setAI{ai=false} @self
  - delay 22
  - skill{s=Nocsy_Drakonin_Spell-Night_Dash}
  

############################################
#             Spell Entities               #
############################################

#----------- Fire Spell -----------#
Nocsy_Drakonin_SpellEntity-Fire-Hold:
  Conditions:
  - altitude{h=1.5to300000} castInstead Nocsy_Drakonin_SpellEntity-Fire-Gravity
  Skills:
  - lunge{velocity=0.01;velocityY=7} @SelfLocation{y=1}
Nocsy_Drakonin_SpellEntity-Fire-Gravity:
  Conditions:
  - hasgravity true
  Skills:
  - setgravity{g=false} @self
Nocsy_Drakonin_SpellEntity-Fire-Spawn:
  Skills:
  - state{s=spawn} @self
  - setvariable{var=caster.spell;value=0;s=CASTER} @self
  - particle{
            a=1;
            s=0.1;
            particle=FLAME;
            amount=2;
            d=true;
            dir=0,1.2,0;
            repeat=1;
            repeatInterval=10;
            } @RingAroundOrigin{r=1;points=30;yOffset=1.5;rx=3.14}
Nocsy_Drakonin_SpellEntity-Fire-Despawn:
  Conditions:
  - hastag{t=despawn} false
  Skills:
  - addtag{t=despawn} @self
  - state{s=despawn} @self
  - particle{
            a=1;
            s=0.2;
            particle=FLAME;
            amount=2;
            d=true;
            } @Sphere{r=1;points=30;yOffset=0;rx=3.14}
  - sound{s=entity.firework_rocket.large_blast;v=1;p=0.1} @self
  - delay 10 #VALUE
  - particle{
            a=1;
            s=0.3;
            particle=FLAME;
            amount=2;
            d=true;
            } @Sphere{r=1.5;points=80;yOffset=0;rx=3.14}
  - sound{s=entity.firework_rocket.large_blast;v=1;p=0.8} @self
  - delay 5
  - particle{
            a=1;
            s=0.2;
            particle=FLAME;
            amount=2;
            d=true;
            } @RingAroundOrigin{r=1;points=30;yOffset=1.5;rx=3.14}
  - remove @self
Nocsy_Drakonin_SpellEntity-Fire-Cast:
  Skills:
  - variableadd{var=caster.spell;amount=1} @self
  - skill{s=Nocsy_Drakonin_Spell-Fire-Missile} @ENO{r=20;sort=RANDOM;limit=1;ignore=players,samefaction}
  - skill{s=Nocsy_Drakonin_SpellEntity-Fire-Despawn-Count}

Nocsy_Drakonin_SpellEntity-Fire-Despawn-Count:
  Conditions:
  - variableEquals{var=caster.spell;value=3}
  Skills:
  - skill{s=Nocsy_Drakonin_SpellEntity-Fire-Despawn}
  
  
#----------- Water Spell -----------#
Nocsy_Drakonin_SpellEntity-Water-Spawn:
  Skills:
  - state{s=spawn} @self
  - delay 7
  - particle{
             a=1;
             s=0.6;
             particle=explosion_normal;
             amount=2;
             d=true;
             dir=0,0.5,0;
             repeat=10;
             repeatInterval=2;
            } @SelfLocation{y=0.3}
  - skill{s=[
            - throw{velocity=2;velocityY=18}
            - particle{
                        a=1;
                        s=0.2;
                        particle=explosion_normal;
                        amount=2;
                        d=true;
                        dir=0,-1,0;
                        repeat=30;
                        repeatInterval=3;
                      }
            ]} @ENO{r=2;ignore=players,samefaction}
Nocsy_Drakonin_SpellEntity-Water-Despawn:
  Skills:
  - state{s=despawn} @self
  - delay 0 #VALUE
  - remove @self
Nocsy_Drakonin_SpellEntity-Water-Cast:
  Skills: []

#----------- Volcanic Spell -----------#
Nocsy_Drakonin_SpellEntity-Volcanic-Spawn:
  Skills:
  - state{s=spawn} @self
  - delay 6
  - ignite{ticks=100} @ENO{r=2;ignore=players,samefaction}
  - damage{a=10} @ENO{r=2;ignore=players,samefaction}
  - throw{velocity=4;velocityY=5} @ENO{r=2;ignore=players,samefaction}
Nocsy_Drakonin_SpellEntity-Volcanic-Despawn:
  Skills:
  - state{s=despawn} @self
  - delay 0 #VALUE
  - remove @self
Nocsy_Drakonin_SpellEntity-Volcanic-Cast:
  Skills: []

#----------- Poison Spell -----------#
Nocsy_Drakonin_SpellEntity-Poison-Spawn:
  Skills:
  - state{s=spawn} @self
Nocsy_Drakonin_SpellEntity-Poison-Despawn:
  Skills:
  - state{s=despawn} @self
  - delay 0 #VALUE
  - remove @self
Nocsy_Drakonin_SpellEntity-Poison-Cast:
  Skills:
  - skill{s=[
            - damage{a=1;preventknockback=true}
            - potion{type=SLOW;duration=20;lvl=3;hasParticles=false}
          ]} @ENO{r=1.1;ignore=players,samefaction}
  - particle{
            a=1;
            s=0.6;
            particle=TOTEM;
            amount=2;
            d=true;
            dir=0,1.2,0;
            repeat=1;
            repeatInterval=10;
            } @RingAroundOrigin{r=1;points=10;yOffset=1.5;rx=3.14}

#----------- Roots Spell -----------#
Nocsy_Drakonin_SpellEntity-Forest-Spawn:
  Skills:
  - state{s=spawn;li=0;lo=0;speed=1.5} @self
  - potion{type=SLOW;duration=120;lvl=126;hasParticles=false} @ENO{r=1;sort=NEAREST;ignore=players,samefaction}
  - damage{a=2;repeat=6;repeatInterval=20;preventknockback=true}
Nocsy_Drakonin_SpellEntity-Forest-Despawn:
  Skills:
  - state{s=despawn;} @self
  - delay 0 #VALUE
  - remove @self
Nocsy_Drakonin_SpellEntity-Forest-Cast:
  Skills: []